!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var o in n)("object"==typeof exports?exports:e)[o]=n[o]}}(window,function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s="./src/main.js")}({"./src/main.js":function(e,t,n){"use strict";n.r(t),n.d(t,"ajaxFn",function(){return r}),n.d(t,"ajax",function(){return a});const o=Promise,r=(e,t,n,r,a={})=>s=>{let i;return s={...a,...s},o.prototype.cancel=(()=>{i instanceof XMLHttpRequest&&(i.__ABORTED__=!0,i.abort(),i=null,console.log("XMLHttpRequest Abort"))}),new o(async(o,a)=>{const{onBefore:c,onAfter:l}=s;if(c&&"function"==typeof c)try{s=await c(s)||s}catch(e){console.log(e)}let{url:u,param:d,type:f="GET",localData:p,onProgress:y,noLoading:m=!1,requestType:g,tipMsg:h,headers:j}=s;if(!u&&!p)return console.error("请求地址不存在"),void a({msg:"开发时提示~参数错误"});!m&&e&&e(h);let w=async e=>{if(l&&"function"==typeof l)try{e=await l(e)||e}catch(e){return}if(n){if(n(e))return}if(e.state)"SUCCESS"===e.state?o({status:1,data:{...e}}):a({msg:e.state,...e});else switch(e.status){case 1:case!0:return void o(e);case 0:case!1:return void a({msg:"网络不稳定，请稍后重试",...e});default:r&&r(e,o,a)}};if(p)return!m&&t&&t(),void w(p);Date.now();let O=f.toUpperCase(),b="json"===g,x="form-data:json"===g;i=new XMLHttpRequest;try{i.onreadystatechange=(()=>{if(4==i.readyState){if(!m&&t&&t(m),i.status>=200&&i.status<300)try{let e=JSON.parse(i.responseText);w(e)}catch(e){a({retcode:i.status,msg:"网络不稳定，请稍后重试."})}else{if(0===i.status&&!0===i.__ABORTED__)return;a({retcode:i.status,msg:"网络不稳定，请稍后重试.."})}i=null}});let e=[];for(let t in d)(d[t]||!1===d[t]||0===d[t])&&e.push(t+"="+encodeURIComponent(d[t]));if("FORM"===O){let e=new FormData;d.data&&Object.keys(d.data).map(t=>{e.append(t,d.data[t])});let t=void 0;"[object Blob]"===Object.prototype.toString.call(d.file)&&(t=d.file.name||t),e.append(d.filename||"Filedata",d.file,t),i.upload.onprogress=(e=>{e.total>0&&(e._percent=e.loaded/e.total*100,e.percent=e._percent.toFixed(2)),y&&y(e)}),i.open("POST",u),i.withCredentials=!0,i.setRequestHeader("X-Requested-With","XMLHttpRequest"),i.send(e)}else if("JSONP"===O){O="GET",d.callback||a({status:0}),window[d.callback]=(e=>{w(e)}),e.length>0&&(u+=(u.indexOf("?")>-1?"&":"?")+e.join("&"));let t=document.createElement("script"),n=document.getElementsByTagName("head")[0];t.src=u,n.appendChild(t)}else{let t=void 0;switch(O){case"PUT":case"POST":t="object"==typeof d?JSON.stringify(d):void 0;break;case"DELETE":case"GET":e.length>0&&(u+=(u.indexOf("?")>-1?"&":"?")+e.join("&"))}i.open(O,u,!0),i.withCredentials=!0,i.setRequestHeader("Content-Type",b?"application/json;charset=utf-8":"application/x-www-form-urlencoded"),i.setRequestHeader("X-Requested-With","XMLHttpRequest");for(const e in j)j.hasOwnProperty(e)&&null!==j[e]&&i.setRequestHeader(e,j[e]);b?i.send(t):i.send("POST"===O?x?`data=${encodeURIComponent(JSON.stringify(d))}`:e.join("&"):void 0)}}catch(e){console.error(e)}})},a=r()}})});